<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>isFiniteå˜é‡åå†²çªä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        button {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>isFiniteå˜é‡åå†²çªä¿®å¤æµ‹è¯•</h1>
    
    <div>
        <button onclick="testIsFiniteFix()">æµ‹è¯•ä¿®å¤</button>
        <div id="testResult"></div>
    </div>

    <script>
        // æ¨¡æ‹Ÿä¿®å¤åçš„åæ ‡éªŒè¯å‡½æ•°
        function isValidCoordinates(position) {
            if (!position || typeof position.lng !== 'number' || typeof position.lat !== 'number') {
                return false
            }
            
            // æ£€æŸ¥æ˜¯å¦ä¸ºNaN
            if (isNaN(position.lng) || isNaN(position.lat)) {
                return false
            }
            
            // æ£€æŸ¥ç»çº¬åº¦èŒƒå›´æ˜¯å¦åˆç†
            const isValidLng = position.lng >= -180 && position.lng <= 180
            const isValidLat = position.lat >= -90 && position.lat <= 90
            
            // æ£€æŸ¥æ˜¯å¦ä¸º0åæ ‡ï¼ˆé€šå¸¸è¡¨ç¤ºæ— æ•ˆåæ ‡ï¼‰
            const isNotZero = position.lng !== 0 || position.lat !== 0
            
            // æ£€æŸ¥æ˜¯å¦ä¸ºæœ‰é™æ•°å­— - ä¿®å¤åçš„å˜é‡å
            const isFiniteNumber = isFinite(position.lng) && isFinite(position.lat)
            
            return isValidLng && isValidLat && isNotZero && isFiniteNumber
        }

        function testIsFiniteFix() {
            const testCases = [
                { position: { lng: 116.397428, lat: 39.90923 }, expected: true, name: 'æœ‰æ•ˆåæ ‡' },
                { position: { lng: NaN, lat: 39.90923 }, expected: false, name: 'NaNç»åº¦' },
                { position: { lng: 116.397428, lat: NaN }, expected: false, name: 'NaNçº¬åº¦' },
                { position: { lng: Infinity, lat: 39.90923 }, expected: false, name: 'æ— ç©·å¤§ç»åº¦' },
                { position: { lng: 116.397428, lat: -Infinity }, expected: false, name: 'è´Ÿæ— ç©·å¤§çº¬åº¦' },
                { position: { lng: 0, lat: 0 }, expected: false, name: 'é›¶åæ ‡' },
                { position: { lng: 181, lat: 39.90923 }, expected: false, name: 'è¶…å‡ºç»åº¦èŒƒå›´' },
                { position: { lng: 116.397428, lat: 91 }, expected: false, name: 'è¶…å‡ºçº¬åº¦èŒƒå›´' }
            ]

            let resultHtml = '<div class="test-title">æµ‹è¯•ç»“æœ:</div>'
            let allPassed = true

            testCases.forEach((testCase, index) => {
                try {
                    const result = isValidCoordinates(testCase.position)
                    const passed = result === testCase.expected
                    
                    if (passed) {
                        resultHtml += `<div class="test-result success">âœ… æµ‹è¯• ${index + 1}: ${testCase.name} - é€šè¿‡</div>`
                    } else {
                        resultHtml += `<div class="test-result error">âŒ æµ‹è¯• ${index + 1}: ${testCase.name} - å¤±è´¥ (æœŸæœ›: ${testCase.expected}, å®é™…: ${result})</div>`
                        allPassed = false
                    }
                } catch (error) {
                    resultHtml += `<div class="test-result error">âŒ æµ‹è¯• ${index + 1}: ${testCase.name} - å¼‚å¸¸: ${error.message}</div>`
                    allPassed = false
                }
            })

            if (allPassed) {
                resultHtml += `<div class="test-result success">ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼isFiniteå˜é‡åå†²çªå·²ä¿®å¤ã€‚</div>`
            } else {
                resultHtml += `<div class="test-result error">âš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ã€‚</div>`
            }

            document.getElementById('testResult').innerHTML = resultHtml
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = function() {
            console.log('isFiniteå˜é‡åå†²çªä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½')
            testIsFiniteFix()
        }
    </script>
</body>
</html> 