<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>车辆过滤功能测试</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    .header {
      background: #1890ff;
      color: white;
      padding: 20px;
      text-align: center;
    }
    
    .content {
      padding: 20px;
    }
    
    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      border: 1px solid #e8e8e8;
      border-radius: 6px;
    }
    
    .test-section h3 {
      margin-top: 0;
      color: #1890ff;
    }
    
    .filter-demo {
      display: grid;
      grid-template-columns: 300px 1fr;
      gap: 20px;
      height: 600px;
    }
    
    .filter-panel {
      background: #fafafa;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #e8e8e8;
    }
    
    .filter-item {
      margin-bottom: 15px;
    }
    
    .filter-item label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
      color: #333;
    }
    
    .filter-item input,
    .filter-item select {
      width: 100%;
      padding: 8px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      font-size: 14px;
    }
    
    .filter-item input:focus,
    .filter-item select:focus {
      outline: none;
      border-color: #1890ff;
      box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
    }
    
    .filter-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    
    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    .btn-primary {
      background: #1890ff;
      color: white;
    }
    
    .btn-primary:hover {
      background: #40a9ff;
    }
    
    .btn-default {
      background: #f0f0f0;
      color: #333;
    }
    
    .btn-default:hover {
      background: #e0e0e0;
    }
    
    .vehicle-list {
      background: white;
      border: 1px solid #e8e8e8;
      border-radius: 6px;
      overflow: hidden;
    }
    
    .vehicle-list-header {
      background: #fafafa;
      padding: 12px 15px;
      border-bottom: 1px solid #e8e8e8;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .vehicle-list-content {
      height: 500px;
      overflow-y: auto;
    }
    
    .vehicle-item {
      padding: 12px 15px;
      border-bottom: 1px solid #f0f0f0;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .vehicle-item:hover {
      background: #f5f5f5;
    }
    
    .vehicle-no {
      font-weight: 600;
      color: #333;
      min-width: 100px;
    }
    
    .vehicle-type {
      color: #666;
      min-width: 60px;
    }
    
    .vehicle-group {
      color: #1890ff;
      min-width: 120px;
    }
    
    .vehicle-status {
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .status-online {
      background: #f6ffed;
      color: #52c41a;
      border: 1px solid #b7eb8f;
    }
    
    .status-parking {
      background: #fffbe6;
      color: #faad14;
      border: 1px solid #ffe58f;
    }
    
    .status-offline {
      background: #fff2f0;
      color: #ff4d4f;
      border: 1px solid #ffccc7;
    }
    
    .stats {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .stat-item {
      background: #f6ffed;
      padding: 10px 15px;
      border-radius: 6px;
      border: 1px solid #b7eb8f;
    }
    
    .stat-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }
    
    .stat-value {
      font-size: 18px;
      font-weight: 600;
      color: #52c41a;
    }
    
    .no-data {
      text-align: center;
      padding: 40px;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🚗 车辆过滤功能测试</h1>
      <p>测试车辆列表的检索过滤功能，包括车牌、终端号码、车辆状态、车辆类型、车组和公司过滤</p>
    </div>
    
    <div class="content">
      <!-- 统计信息 -->
      <div class="test-section">
        <h3>📊 车辆统计信息</h3>
        <div class="stats" id="stats">
          <div class="stat-item">
            <div class="stat-label">总车辆数</div>
            <div class="stat-value" id="totalVehicles">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">在线车辆</div>
            <div class="stat-value" id="onlineVehicles">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">停车车辆</div>
            <div class="stat-value" id="parkingVehicles">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">离线车辆</div>
            <div class="stat-value" id="offlineVehicles">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">车组数量</div>
            <div class="stat-value" id="groupCount">0</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">公司数量</div>
            <div class="stat-value" id="companyCount">0</div>
          </div>
        </div>
      </div>
      
      <!-- 过滤演示 -->
      <div class="test-section">
        <h3>🔍 过滤功能演示</h3>
        <div class="filter-demo">
          <div class="filter-panel">
            <h4>过滤条件</h4>
            
            <div class="filter-item">
              <label>车牌号</label>
              <input type="text" id="vehicleNoFilter" placeholder="输入车牌号">
            </div>
            
            <div class="filter-item">
              <label>终端号码</label>
              <input type="text" id="terminalIdFilter" placeholder="输入终端号码">
            </div>
            
            <div class="filter-item">
              <label>车辆状态</label>
              <select id="statusFilter">
                <option value="">全部状态</option>
                <option value="1">在线</option>
                <option value="2">停车</option>
                <option value="0">离线</option>
              </select>
            </div>
            
            <div class="filter-item">
              <label>车辆类型</label>
              <select id="vehicleTypeFilter">
                <option value="">全部类型</option>
                <option value="货车">货车</option>
                <option value="客车">客车</option>
                <option value="轿车">轿车</option>
                <option value="面包车">面包车</option>
                <option value="厢式车">厢式车</option>
              </select>
            </div>
            
            <div class="filter-item">
              <label>车组</label>
              <select id="groupIdFilter">
                <option value="">全部车组</option>
                <option value="G001">北京运输一队</option>
                <option value="G002">北京客运一队</option>
                <option value="G003">北京物流一队</option>
                <option value="G004">北京快递一队</option>
                <option value="G005">北京租赁一队</option>
              </select>
            </div>
            
            <div class="filter-item">
              <label>公司</label>
              <select id="companyFilter">
                <option value="">全部公司</option>
                <option value="北京运输有限公司">北京运输有限公司</option>
                <option value="北京客运集团">北京客运集团</option>
                <option value="北京物流有限公司">北京物流有限公司</option>
                <option value="北京快递有限公司">北京快递有限公司</option>
                <option value="北京汽车租赁有限公司">北京汽车租赁有限公司</option>
              </select>
            </div>
            
            <div class="filter-actions">
              <button class="btn btn-primary" onclick="applyFilters()">应用过滤</button>
              <button class="btn btn-default" onclick="resetFilters()">重置</button>
            </div>
            
            <div style="margin-top: 15px; font-size: 12px; color: #666;">
              <div>显示: <span id="filteredCount">0</span>/<span id="totalCount">0</span></div>
              <div id="filterActive" style="color: #1890ff; display: none;">🔍 已应用过滤条件</div>
            </div>
          </div>
          
          <div class="vehicle-list">
            <div class="vehicle-list-header">
              <h4>车辆列表</h4>
              <span id="listCount">0 辆车</span>
            </div>
            <div class="vehicle-list-content" id="vehicleList">
              <!-- 车辆列表将在这里动态生成 -->
            </div>
          </div>
        </div>
      </div>
      
      <!-- 测试用例 -->
      <div class="test-section">
        <h3>🧪 测试用例</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
          <button class="btn btn-default" onclick="testFilter('vehicleNo', '京A')">测试车牌号过滤</button>
          <button class="btn btn-default" onclick="testFilter('terminalId', 'T0')">测试终端号码过滤</button>
          <button class="btn btn-default" onclick="testFilter('status', '1')">测试在线状态过滤</button>
          <button class="btn btn-default" onclick="testFilter('vehicleType', '货车')">测试货车类型过滤</button>
          <button class="btn btn-default" onclick="testFilter('groupId', 'G001')">测试运输一队过滤</button>
          <button class="btn btn-default" onclick="testFilter('company', '北京运输有限公司')">测试公司过滤</button>
          <button class="btn btn-default" onclick="testMultipleFilters()">测试多条件过滤</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    // 导入模拟数据
    import { allMockVehicles, vehicleGroups } from '../src/utils/mockData.js'
    import { filterVehicles, getFilterStats } from '../src/utils/filterUtils.js'
    
    // 全局变量
    let allVehicles = []
    let filteredVehicles = []
    let currentFilters = {
      vehicleNo: '',
      terminalId: '',
      status: '',
      vehicleType: '',
      groupId: '',
      company: ''
    }
    
    // 初始化
    function init() {
      allVehicles = allMockVehicles
      filteredVehicles = [...allVehicles]
      
      updateStats()
      renderVehicleList()
      updateFilterStats()
      
      // 绑定事件
      document.getElementById('vehicleNoFilter').addEventListener('input', handleFilterChange)
      document.getElementById('terminalIdFilter').addEventListener('input', handleFilterChange)
      document.getElementById('statusFilter').addEventListener('change', handleFilterChange)
      document.getElementById('vehicleTypeFilter').addEventListener('change', handleFilterChange)
      document.getElementById('groupIdFilter').addEventListener('change', handleFilterChange)
      document.getElementById('companyFilter').addEventListener('change', handleFilterChange)
    }
    
    // 更新统计信息
    function updateStats() {
      const stats = {
        total: allVehicles.length,
        online: allVehicles.filter(v => v.status === 1).length,
        parking: allVehicles.filter(v => v.status === 2).length,
        offline: allVehicles.filter(v => v.status === 0).length
      }
      
      const groups = [...new Set(allVehicles.map(v => v.groupId).filter(Boolean))]
      const companies = [...new Set(allVehicles.map(v => v.company).filter(Boolean))]
      
      document.getElementById('totalVehicles').textContent = stats.total
      document.getElementById('onlineVehicles').textContent = stats.online
      document.getElementById('parkingVehicles').textContent = stats.parking
      document.getElementById('offlineVehicles').textContent = stats.offline
      document.getElementById('groupCount').textContent = groups.length
      document.getElementById('companyCount').textContent = companies.length
    }
    
    // 处理过滤条件变化
    function handleFilterChange() {
      currentFilters = {
        vehicleNo: document.getElementById('vehicleNoFilter').value,
        terminalId: document.getElementById('terminalIdFilter').value,
        status: document.getElementById('statusFilter').value,
        vehicleType: document.getElementById('vehicleTypeFilter').value,
        groupId: document.getElementById('groupIdFilter').value,
        company: document.getElementById('companyFilter').value
      }
      
      applyFilters()
    }
    
    // 应用过滤
    function applyFilters() {
      filteredVehicles = filterVehicles(allVehicles, currentFilters)
      renderVehicleList()
      updateFilterStats()
    }
    
    // 重置过滤
    function resetFilters() {
      document.getElementById('vehicleNoFilter').value = ''
      document.getElementById('terminalIdFilter').value = ''
      document.getElementById('statusFilter').value = ''
      document.getElementById('vehicleTypeFilter').value = ''
      document.getElementById('groupIdFilter').value = ''
      document.getElementById('companyFilter').value = ''
      
      currentFilters = {
        vehicleNo: '',
        terminalId: '',
        status: '',
        vehicleType: '',
        groupId: '',
        company: ''
      }
      
      applyFilters()
    }
    
    // 更新过滤统计
    function updateFilterStats() {
      const stats = getFilterStats(allVehicles, filteredVehicles)
      document.getElementById('filteredCount').textContent = stats.filtered
      document.getElementById('totalCount').textContent = stats.total
      document.getElementById('listCount').textContent = `${stats.filtered} 辆车`
      
      const hasActiveFilters = Object.values(currentFilters).some(v => v !== '')
      document.getElementById('filterActive').style.display = hasActiveFilters ? 'block' : 'none'
    }
    
    // 渲染车辆列表
    function renderVehicleList() {
      const container = document.getElementById('vehicleList')
      
      if (filteredVehicles.length === 0) {
        container.innerHTML = '<div class="no-data">暂无符合条件的车辆</div>'
        return
      }
      
      const html = filteredVehicles.map(vehicle => {
        const statusClass = vehicle.status === 1 ? 'status-online' : 
                           vehicle.status === 2 ? 'status-parking' : 'status-offline'
        const statusText = vehicle.status === 1 ? '在线' : 
                          vehicle.status === 2 ? '停车' : '离线'
        
        return `
          <div class="vehicle-item">
            <div class="vehicle-no">${vehicle.vehicleNo}</div>
            <div class="vehicle-type">${vehicle.vehicleType}</div>
            <div class="vehicle-group">${vehicle.groupName || '-'}</div>
            <div class="vehicle-status ${statusClass}">${statusText}</div>
          </div>
        `
      }).join('')
      
      container.innerHTML = html
    }
    
    // 测试过滤功能
    window.testFilter = function(type, value) {
      document.getElementById(`${type}Filter`).value = value
      handleFilterChange()
    }
    
    window.testMultipleFilters = function() {
      document.getElementById('vehicleNoFilter').value = '京A'
      document.getElementById('statusFilter').value = '1'
      document.getElementById('vehicleTypeFilter').value = '货车'
      handleFilterChange()
    }
    
    window.applyFilters = applyFilters
    window.resetFilters = resetFilters
    
    // 启动应用
    init()
  </script>
</body>
</html> 